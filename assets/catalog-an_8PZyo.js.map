{"version":3,"file":"catalog-an_8PZyo.js","sources":["../../src/js/catalog.js"],"sourcesContent":["// ===== IMPORTS =====\nimport * as API from '../api/api.js';\nimport { initPagination, renderPagination } from './pagination.js';\nimport * as basicLightbox from 'basiclightbox';\nimport 'basiclightbox/dist/basicLightbox.min.css';\n\n// ===== CONFIGURATION =====\nconst CONFIG = {\n  IMAGE_BASE_URL: 'https://image.tmdb.org/t/p/w500',\n  IMAGE_BASE_URL_2X: 'https://image.tmdb.org/t/p/w780',\n  BACKDROP_BASE_URL: 'https://image.tmdb.org/t/p/w1280',\n  BACKDROP_BASE_URL_2X: 'https://image.tmdb.org/t/p/w1920',\n  IMAGE_PLACEHOLDER: 'src/images/no-poster.svg',\n};\n\n// ===== DOM ELEMENTS CACHE =====\nlet DOM;\n\n// ===== EVENT HANDLERS =====\nlet movieCardClickHandler = null;\n\n// ===== APPLICATION STATE =====\nconst AppState = {\n  lastSearch: { input: '', year: '', isSearch: false },\n  genresCache: [],\n};\n\n// ===== UTILITY FUNCTIONS =====\nfunction extractYear(releaseDate) {\n  return releaseDate ? releaseDate.split('-')[0] : '—';\n}\n\nfunction toggleLibraryButton(movie, button) {\n  let library = JSON.parse(localStorage.getItem('library')) || [];\n  const isInLibrary = library.some(\n    item => Number(item.id) === Number(movie.id)\n  );\n  if (isInLibrary) {\n    library = library.filter(item => Number(item.id) !== Number(movie.id));\n    button.textContent = 'Add to Library';\n    button.classList.remove('remove-from-library');\n    button.classList.add('library-btn-w');\n  } else {\n    if (!movie.genre_ids && movie.genres) {\n      movie.genre_ids = movie.genres.map(g => g.id);\n    }\n    library.push(movie);\n    button.textContent = 'Remove from my library';\n    button.classList.remove('library-btn-w');\n    button.classList.add('remove-from-library');\n  }\n  localStorage.setItem('library', JSON.stringify(library));\n}\n\nfunction getImageUrl(posterPath) {\n  if (!posterPath) return CONFIG.IMAGE_PLACEHOLDER;\n  const baseUrl =\n    window.devicePixelRatio > 1\n      ? CONFIG.IMAGE_BASE_URL_2X\n      : CONFIG.IMAGE_BASE_URL;\n  return baseUrl + posterPath;\n}\n\nfunction getImageSrcset(posterPath) {\n  if (!posterPath) return CONFIG.IMAGE_PLACEHOLDER;\n  const smallUrl = CONFIG.IMAGE_BASE_URL.replace('/w500', '/w300') + posterPath;\n  const largeUrl = CONFIG.IMAGE_BASE_URL + posterPath;\n  return `${smallUrl} 1x, ${largeUrl} 2x`;\n}\n\nfunction getBackdropUrl(backdropPath) {\n  if (!backdropPath) return CONFIG.IMAGE_PLACEHOLDER;\n  const baseUrl =\n    window.devicePixelRatio > 1\n      ? CONFIG.BACKDROP_BASE_URL_2X\n      : CONFIG.BACKDROP_BASE_URL;\n  return baseUrl + backdropPath;\n}\n\n// ===== ERROR HANDLING =====\nfunction showErrorMessage(message, type = 'error') {\n  const errorDiv = document.createElement('div');\n  errorDiv.className = `error-message ${type}`;\n  errorDiv.textContent = message;\n  errorDiv.style.cssText = `\n    position: fixed;\n    top: 20px;\n    right: 20px;\n    background: linear-gradient(135deg, rgba(0, 0, 0, 0.9) 0%, rgba(20, 20, 20, 0.95) 100%);\n    color: white;\n    padding: 16px 24px;\n    border-radius: 12px;\n    z-index: 10000;\n    box-shadow: 0 8px 32px rgba(0, 0, 0, 0.5);\n    backdrop-filter: blur(10px);\n    border: 1px solid rgba(255, 255, 255, 0.1);\n    font-weight: 500;\n  `;\n\n  document.body.appendChild(errorDiv);\n  setTimeout(() => errorDiv.remove(), 5000);\n}\n\n// ===== RENDERING FUNCTIONS =====\nfunction renderStarRating(voteAverage, container) {\n  if (!container) return;\n\n  const rating = voteAverage / 2;\n  const fullStars = Math.floor(rating);\n  const hasHalfStar = rating - fullStars >= 0.5;\n  const emptyStars = 5 - fullStars - (hasHalfStar ? 1 : 0);\n\n  let starsHTML = '';\n\n  // Render full stars\n  for (let i = 0; i < fullStars; i++) {\n    starsHTML +=\n      '<svg class=\"catalog-icon catalog-icon-star\"><use xlink:href=\"../images/symbol-defs.svg#icon-star\"></use></svg>';\n  }\n\n  // Render half star if needed\n  if (hasHalfStar) {\n    starsHTML +=\n      '<svg class=\"catalog-icon catalog-icon-star-half\"><use xlink:href=\"../images/symbol-defs.svg#icon-star-half\"></use></svg>';\n  }\n\n  // Render empty stars\n  for (let i = 0; i < emptyStars; i++) {\n    starsHTML +=\n      '<svg class=\"catalog-icon catalog-icon-star-empty\"><use xlink:href=\"../images/symbol-defs.svg#icon-star-empty\"></use></svg>';\n  }\n\n  container.innerHTML = starsHTML;\n}\n\nfunction renderHeroSection(movie) {\n  const heroSection = document.getElementById('hero');\n  if (!heroSection) return;\n\n  // Use backdrop image for better quality, fallback to poster if no backdrop\n  const bgUrl = movie.backdrop_path\n    ? getBackdropUrl(movie.backdrop_path)\n    : getImageUrl(movie.poster_path);\n\n  // Preload high-quality image\n  const img = new Image();\n  img.onload = function () {\n    heroSection.style.backgroundImage = `url(${bgUrl})`;\n    heroSection.style.backgroundSize = 'cover';\n    heroSection.style.backgroundPosition = 'center';\n    heroSection.style.backgroundRepeat = 'no-repeat';\n    heroSection.style.backgroundAttachment = 'fixed';\n    heroSection.style.transition = 'background-image 0.3s ease';\n  };\n  img.src = bgUrl;\n\n  DOM.heroContent.innerHTML = `\n    <div class=\"hero-info\">\n      <h2 class=\"hero-title\">${movie.title}</h2>\n      <div class=\"rating-stars\" id=\"hero-rating-stars\"></div>\n      <p class=\"hero-overview\">${movie.overview || 'No overview available.'}</p>\n      <div class=\"hero-actions\">\n        <button class=\"btn trailer-btn\" data-id=\"${\n          movie.id\n        }\" aria-label=\"Trailer for ${movie.title}\">\n          Watch trailer\n        </button>\n        <button class=\"btn details-btn\" data-id=\"${\n          movie.id\n        }\" aria-label=\"More details for ${movie.title}\">\n          More details\n        </button>\n      </div>\n    </div>\n  `;\n\n  const heroStarsContainer = document.getElementById('hero-rating-stars');\n  renderStarRating(movie.vote_average || 0, heroStarsContainer);\n}\n\nfunction renderMoviesList(movies) {\n  DOM.moviesUl.innerHTML = '';\n\n  if (!movies || movies.length === 0) {\n    DOM.moviesUl.innerHTML = `\n    <li></li>\n      <li class=\"message\" role=\"status\">\n        <div class=\"error-message-content\">\n          <div>OOPS...</div>\n          <div>We are very sorry!</div>\n          <div>We don't have any results matching your search.</div>\n        </div>\n      </li>\n    `;\n    return;\n  }\n\n  const fragment = document.createDocumentFragment();\n  movies.forEach(movie => {\n    const movieCard = createMovieCard(movie);\n    fragment.appendChild(movieCard);\n  });\n  DOM.moviesUl.appendChild(fragment);\n}\n\nfunction createMovieCard(movie) {\n  const li = document.createElement('li');\n  li.className = 'movie-card';\n  li.dataset.id = movie.id;\n  li.style.cursor = 'pointer';\n\n  // Process genres\n  let genresText = '';\n  if (movie.genres && movie.genres.length > 0) {\n    genresText = movie.genres.map(g => g.name).join(', ');\n  } else if (movie.genre_ids && movie.genre_ids.length > 0) {\n    const genreNames = movie.genre_ids\n      .map(id => {\n        const genre = AppState.genresCache.find(g => g.id === id);\n        return genre ? genre.name : '';\n      })\n      .filter(name => name !== '')\n      .slice(0, 2);\n    genresText = genreNames.join(', ');\n  }\n\n  const releaseYear = extractYear(movie.release_date);\n  const genreAndYear = genresText\n    ? `${genresText} | ${releaseYear}`\n    : releaseYear;\n\n  li.innerHTML = `\n    <div class=\"movie-poster\">\n      <img src=\"${getImageUrl(movie.poster_path)}\"\n           alt=\"${movie.title} poster\"\n           loading=\"lazy\"\n           srcset=\"${getImageSrcset(movie.poster_path)}\" />\n    </div>\n    <div class=\"movie-info\">\n      <div class=\"movie-info-left\">\n        <div class=\"movie-title\">${movie.title}</div>\n        <div class=\"movie-meta\">${genreAndYear}</div>\n      </div>\n      <div class=\"movie-info-right\">\n        <div class=\"catalog-rating-stars\"></div>\n      </div>\n    </div>\n  `;\n\n  const starsContainer = li.querySelector('.catalog-rating-stars');\n  renderStarRating(movie.vote_average || 0, starsContainer);\n\n  return li;\n}\n\n// ===== MAIN FUNCTIONS =====\nasync function loadTrendingMovies(page = 1) {\n  try {\n    DOM.movieListRegion.setAttribute('aria-busy', 'true');\n\n    const data = await API.fetchTrendingWeek(page);\n\n    // Only render hero section if hero content exists (may be deactivated)\n    if (DOM.heroContent && page === 1) {\n      const firstMovie = data.results?.[0];\n      if (firstMovie) {\n        renderHeroSection(firstMovie);\n      } else {\n        DOM.heroContent.innerHTML = `\n          <div class=\"hero-fall-back\" style=\"\n            text-align: center; \n            padding: 4rem 2rem; \n            background: rgba(0, 0, 0, 0.8); \n            color: #ffffff; \n            font-family: 'Roboto', sans-serif;\n            line-height: 1.6;\n            border-radius: 12px;\n            backdrop-filter: blur(10px);\n          \">\n            <div style=\"font-size: 1.5rem; font-weight: 400; margin-bottom: 0.5rem;\">OOPS...</div>\n            <div style=\"font-size: 1.2rem; font-weight: 400; margin-bottom: 0.5rem;\">We are very sorry!</div>\n            <div style=\"font-size: 1rem; font-weight: 300; opacity: 0.9;\">We don't have any results matching your search.</div>\n          </div>\n        `;\n      }\n    }\n\n    const movies = data.results || [];\n    renderMoviesList(movies);\n    renderPagination(page, data.total_pages || 1);\n\n    AppState.lastSearch = { input: '', year: '', isSearch: false };\n  } catch (error) {\n    console.error('Error loading trending movies:', error);\n    showErrorMessage('Failed to load trending movies. Please try again later.');\n  } finally {\n    DOM.movieListRegion.removeAttribute('aria-busy');\n  }\n}\n\nasync function performMovieSearch(query, year = '', page = 1) {\n  if (!query || query.trim() === '') {\n    return loadTrendingMovies();\n  }\n\n  try {\n    DOM.movieListRegion.setAttribute('aria-busy', 'true');\n\n    const data = await API.searchMovies(query.trim(), year, page);\n\n    const movies = data.results || [];\n    renderMoviesList(movies);\n    renderPagination(page, data.total_pages || 1);\n\n    AppState.lastSearch = { input: query, year: year, isSearch: true };\n  } catch (error) {\n    console.error('Error performing search:', error);\n    showErrorMessage('Search failed. Please try again.');\n  } finally {\n    DOM.movieListRegion.removeAttribute('aria-busy');\n  }\n}\n\nfunction handlePageChange(page) {\n  if (AppState.lastSearch.isSearch) {\n    performMovieSearch(\n      AppState.lastSearch.input,\n      AppState.lastSearch.year,\n      page\n    );\n  } else {\n    loadTrendingMovies(page);\n  }\n\n  window.scrollTo({ top: 0, behavior: 'smooth' });\n}\n\n// ===== EVENT LISTENERS =====\nfunction setupEventListeners() {\n  // Önceki handler'ı kaldır (eğer varsa)\n  if (movieCardClickHandler) {\n    DOM.moviesUl.removeEventListener('click', movieCardClickHandler);\n  }\n\n  // Movie card click handler'ını tanımla\n  movieCardClickHandler = async e => {\n    const card = e.target.closest('.movie-card');\n    if (!card) return;\n\n    const movieId = card.dataset.id;\n    if (!movieId) return;\n\n    try {\n      const movie = await API.fetchMovieDetails(movieId);\n      const posterUrl = movie.poster_path\n        ? `https://image.tmdb.org/t/p/w500${movie.poster_path}`\n        : `https://via.placeholder.com/500x750?text=No+Image`;\n      const genres = movie.genres.map(g => g.name).join(', ');\n      const library = JSON.parse(localStorage.getItem('library')) || [];\n      const inLibrary = library.some(\n        item => Number(item.id) === Number(movie.id)\n      );\n\n      const popup = basicLightbox.create(\n        `\n        <div class=\"weekly-movie-modal\">\n          <button class=\"popup-close-btn\" aria-label=\"Close\">\n            <svg class=\"icon-close\" width=\"24\" height=\"24\">\n              <use xlink:href=\"../../img/icon.svg#icon-close\"></use>\n            </svg>\n          </button>\n          <img src=\"${posterUrl}\" class=\"modal-poster\" alt=\"${movie.title}\">\n          <div class=\"modal-details\">\n            <h2>${movie.title}</h2>\n            <p><strong>Vote / Votes:</strong> ${movie.vote_average} / ${\n          movie.vote_count\n        }</p>\n            <p><strong>Popularity:</strong> ${movie.popularity}</p>\n            <p><strong>Genre:</strong> ${genres}</p>\n            <h3>ABOUT</h3>\n            <p>${movie.overview}</p>\n            <button class=\"${\n              inLibrary ? 'remove-from-library' : 'library-btn-w'\n            }\">\n              ${inLibrary ? 'Remove from my library' : 'Add to Library'}\n            </button>\n          </div>\n        </div>\n        `,\n        {\n          onShow: instance => {\n            const closeBtn = instance\n              .element()\n              .querySelector('.popup-close-btn');\n            closeBtn.addEventListener('click', () => instance.close());\n            const addBtn = instance\n              .element()\n              .querySelector(\n                'button.remove-from-library, button.library-btn-w'\n              );\n            addBtn.addEventListener('click', () =>\n              toggleLibraryButton(movie, addBtn)\n            );\n          },\n        }\n      );\n      popup.show();\n      function handleEscKey(e) {\n        if (e.key === 'Escape') {\n          popup.close();\n          window.removeEventListener('keydown', handleEscKey);\n        }\n      }\n      window.addEventListener('keydown', handleEscKey);\n    } catch (err) {\n      console.error('Popup açılırken hata:', err);\n    }\n  };\n\n  // Yeni handler'ı ekle\n  DOM.moviesUl.addEventListener('click', movieCardClickHandler);\n\n  // Movie action buttons (works for modal buttons too)\n  document.addEventListener('click', async e => {\n    const trailerBtn = e.target.closest('.trailer-btn');\n    if (trailerBtn) {\n      const movieId = trailerBtn.dataset.id;\n      if (movieId) {\n        await handleTrailerClick(movieId);\n      }\n      return;\n    }\n\n    const detailsBtn = e.target.closest('.details-btn');\n    if (detailsBtn) {\n      const movieId = detailsBtn.dataset.id;\n      if (movieId) {\n        await handleDetailsClick(movieId);\n      }\n    }\n  });\n}\n\n// ===== INITIALIZATION =====\nasync function initializeApp() {\n  try {\n    // Initialize DOM elements\n    DOM = {\n      moviesUl: document.getElementById('movies-ul'),\n      heroContent: document.getElementById('hero-content'),\n      movieListRegion: document.getElementById('movie-list'),\n    };\n\n    // Setup event listeners\n    setupEventListeners();\n\n    // Initialize pagination module\n    initPagination(handlePageChange);\n\n    // Fetch genres cache\n    const genresData = await API.fetchGenres();\n    AppState.genresCache = genresData.genres || [];\n\n    // Only render hero section if hero content exists\n    if (DOM.heroContent) {\n      const dayData = await API.fetchTrendingDay();\n      const heroMovie = dayData.results?.[0];\n      if (heroMovie) {\n        renderHeroSection(heroMovie);\n      }\n    }\n\n    // Load initial trending movies\n    await loadTrendingMovies(1);\n  } catch (error) {\n    console.error('Error initializing app:', error);\n    showErrorMessage('Failed to initialize application.');\n  }\n}\n\n// ===== APP STARTUP =====\nif (document.readyState === 'loading') {\n  document.addEventListener('DOMContentLoaded', initializeApp);\n} else {\n  initializeApp();\n}\n"],"names":["CONFIG","DOM","movieCardClickHandler","AppState","extractYear","releaseDate","toggleLibraryButton","movie","button","library","item","g","getImageUrl","posterPath","getImageSrcset","smallUrl","largeUrl","getBackdropUrl","backdropPath","showErrorMessage","message","type","errorDiv","renderStarRating","voteAverage","container","rating","fullStars","hasHalfStar","emptyStars","starsHTML","i","renderHeroSection","heroSection","bgUrl","img","heroStarsContainer","renderMoviesList","movies","fragment","movieCard","createMovieCard","li","genresText","id","genre","name","releaseYear","genreAndYear","starsContainer","loadTrendingMovies","page","data","API.fetchTrendingWeek","firstMovie","_a","renderPagination","error","performMovieSearch","query","year","API.searchMovies","handlePageChange","setupEventListeners","card","movieId","handleEscKey","e","popup","API.fetchMovieDetails","posterUrl","genres","inLibrary","basicLightbox.create","instance","addBtn","err","trailerBtn","detailsBtn","initializeApp","initPagination","genresData","API.fetchGenres","heroMovie","API.fetchTrendingDay"],"mappings":"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"}