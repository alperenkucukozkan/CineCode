import{f as x}from"./api-yrAdrbr0.js";const _="myLibraryMovies_v1",M="https://image.tmdb.org/t/p/w500",f=e=>{const t=Number(e);return Number.isNaN(t)?0:Math.round(t*10)/10},p=()=>{try{const e=localStorage.getItem(_);return e?JSON.parse(e):{}}catch(e){return console.error("Local Storage okuma hatası:",e),{}}},h=e=>{try{localStorage.setItem(_,JSON.stringify(e))}catch(t){console.error("Local Storage ekleme hatası:",t)}},k=e=>!!p()[e],q=e=>{if(!e||!e.id)return;const t=p();t[e.id]=e,h(t)},w=e=>{const t=p();t[e]&&(delete t[e],h(t))},C=e=>e?`${M}${e}`:"",o=document.querySelector(".modal"),g=document.querySelector(".close-icon"),a=document.querySelector(".modal-img"),b=document.querySelector(".movie-title"),m=document.querySelector(".votes-puanlama"),v=document.querySelector(".votes-oysayisi"),L=document.querySelector(".popularity-value"),S=document.querySelector(".genre-value"),E=document.querySelector(".about-value"),n=document.querySelector(".modal-add-button");let s=null,c=null,i=null;const N=()=>{o&&(o.classList.add("is-open"),o.setAttribute("aria-hidden","false"),s=e=>{e.key==="Escape"&&u()},document.addEventListener("keydown",s),c=e=>{e.target===o&&u()},o.addEventListener("click",c))},u=()=>{o&&(o.classList.remove("is-open"),o.setAttribute("aria-hidden","true"),i=null,s&&document.removeEventListener("keydown",s),c&&o.removeEventListener("click",c))};g&&g.addEventListener("click",e=>{e.stopPropagation(),u()});const y=e=>{if(!n)return;const t=k(e);n.textContent=t?"Remove from my Library":"Add to my Library",n.dataset.inLibrary=t?"true":"false",n.dataset.movieId=e},D=e=>{if(!e)return;i=e;const t=e.poster_path||e.backdrop_path||"",l=C(t);if(a&&(l?(a.src=l,a.alt=e.title||e.name||"Movie Poster"):(a.src="",a.alt="Poster not available")),b&&(b.textContent=e.title||e.name||"No title"),m){const r=f(e.vote_average??0);m.textContent=r.toFixed(1)}if(v&&(v.textContent=e.vote_count??0),L){const r=f(e.popularity??0);L.textContent=r.toFixed(1)}if(S){let r="-";Array.isArray(e.genres)&&e.genres.length>0?r=e.genres.map(d=>d.name).slice(0,3).join(", "):e.genre_ids&&Array.isArray(e.genre_ids)&&(r=e.genre_ids.join(", ")),S.textContent=r}E&&(E.textContent=e.overview||e.description||"No description available."),y(e.id)};n&&n.addEventListener("click",async e=>{e.preventDefault();const t=n.dataset.movieId||i&&i.id;if(!t)return;if(k(t)){w(t),y(t);return}let r=i;if(!r||String(t)!==String(r.id))try{r=await x(t)}catch(A){console.error("fetchMovieDetails fonksiyonu hatası:",A);return}const d={id:r.id,title:r.title||r.name||"",poster_path:r.poster_path||"",vote_average:r.vote_average??0,vote_count:r.vote_count??0,popularity:r.popularity??0,genres:r.genres??r.genre_ids??[],overview:r.overview||"",savedAt:new Date().toISOString()};q(d),y(t)});export{u as closeModal,N as openModal,D as renderMovieInModal};
//# sourceMappingURL=modal-S3JN022D.js.map
